<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Music Player</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: black;
        color: white;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }

    h1 {
        margin-bottom: 20px;
        text-align: center;
    }

    #controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
        margin-bottom: 20px;
        z-index: 10;
        position: relative;
    }

    button {
        padding: 10px 15px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        background: #ff4c4c;
        color: white;
        cursor: pointer;
        transition: 0.2s;
    }

    button:hover {
        background: #ff1c1c;
    }

    #repeat.on {
        animation: pulse 1s infinite alternate;
        box-shadow: 0 0 20px white;
    }

    @keyframes pulse {
        0% { box-shadow: 0 0 10px white; }
        100% { box-shadow: 0 0 40px white; }
    }

    input[type="range"] {
        width: 150px;
    }

    #visualizer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: black;
        z-index: 0;
    }
</style>
</head>
<body>
<h1>Ultimate Music Player</h1>

<div id="controls">
    <button id="playPause">‚ñ∂Ô∏è / ‚è∏Ô∏è</button>
    <button id="speedDown">üê¢ -5</button>
    <button id="speedUp">üöÄ +5</button>
    <button id="repeat">üîÅ</button>
    <label>üîä Volume: <input type="range" id="volume" min="0" max="1500" value="750"></label>
    <label>üé∏ Bass: <input type="range" id="bass" min="0" max="500" value="250"></label>
</div>

<select id="songSelect">
    <option value="https://dl.dropboxusercontent.com/scl/fi/yhld02nhkv67ybatemdzy/SOL-VIBRA-Slowed-DJ-Zarek.mp3?rlkey=sy5qtggjtiu0o52bq9an5qufc&st=emcx226l&dl=0">SOL VIBRA - DJ ZAREK</option>
    <option value="https://dl.dropboxusercontent.com/scl/fi/rtia97mai2ad1aq2ubsli/SKRILLEX-Bangarang-feat.-Sirah-Official-Music-Video-Skrillex.mp3?rlkey=t08e51k2s2u28mi90pfv3jyhq&st=j6bu3i2w&dl=0">BANGERANG - SKRILLEX</option>
    <option value="https://dl.dropboxusercontent.com/scl/fi/6o75o7ad2z9ivhmxf8zt9/YNW-Melly-Murder-On-My-Mind-Official-Video-YNW-Melly.mp3?rlkey=97e7gwygwanqrpovx60sn7jwm&st=i4pobosa&dl=0">MURDER ON MY MIND - YNW MELLY</option>
</select>

<audio id="audio" src="" crossorigin="anonymous"></audio>
<canvas id="visualizer"></canvas>

<script>
const audio = document.getElementById('audio');
const playPauseBtn = document.getElementById('playPause');
const speedUpBtn = document.getElementById('speedUp');
const speedDownBtn = document.getElementById('speedDown');
const volumeSlider = document.getElementById('volume');
const bassSlider = document.getElementById('bass');
const repeatBtn = document.getElementById('repeat');
const songSelect = document.getElementById('songSelect');

let isPlaying = false;
let repeat = false;

// Audio Context for bass + visualizer
const AudioContext = window.AudioContext || window.webkitAudioContext;
const ctx = new AudioContext();
const source = ctx.createMediaElementSource(audio);
const gainNode = ctx.createGain();
const bassFilter = ctx.createBiquadFilter();
bassFilter.type = "lowshelf";
bassFilter.frequency.value = 200;

source.connect(bassFilter);
bassFilter.connect(gainNode);
gainNode.connect(ctx.destination);

// Visualizer setup
const canvas = document.getElementById('visualizer');
const cctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const analyser = ctx.createAnalyser();
bassFilter.connect(analyser);
analyser.fftSize = 1024;
const bufferLength = analyser.frequencyBinCount;
const dataArray = new Uint8Array(bufferLength);

function drawVisualizer() {
    requestAnimationFrame(drawVisualizer);
    analyser.getByteFrequencyData(dataArray);

    cctx.fillStyle = 'rgba(0,0,0,0.1)';
    cctx.fillRect(0, 0, canvas.width, canvas.height);

    cctx.beginPath();
    const sliceWidth = canvas.width / bufferLength;
    let x = 0;
    for (let i = 0; i < bufferLength; i++) {
        const y = canvas.height/2 - dataArray[i];
        if(i===0) cctx.moveTo(x, y);
        else cctx.lineTo(x, y);
        x += sliceWidth;
    }
    cctx.strokeStyle = 'white';
    cctx.lineWidth = 2;
    cctx.shadowColor = 'white';
    cctx.shadowBlur = 20;
    cctx.stroke();
}

drawVisualizer();

// Button actions
playPauseBtn.onclick = () => {
    if (!isPlaying) {
        ctx.resume().then(() => audio.play());
        playPauseBtn.textContent = '‚è∏Ô∏è / ‚ñ∂Ô∏è';
    } else {
        audio.pause();
        playPauseBtn.textContent = '‚ñ∂Ô∏è / ‚è∏Ô∏è';
    }
    isPlaying = !isPlaying;
};

speedUpBtn.onclick = () => {
    audio.playbackRate += 0.05;
};

speedDownBtn.onclick = () => {
    audio.playbackRate = Math.max(0.05, audio.playbackRate - 0.05);
};

volumeSlider.oninput = () => {
    gainNode.gain.value = volumeSlider.value / 1000;
};

bassSlider.oninput = () => {
    bassFilter.gain.value = bassSlider.value;
};

repeatBtn.onclick = () => {
    repeat = !repeat;
    repeatBtn.classList.toggle('on', repeat);
};

songSelect.onchange = () => {
    audio.src = songSelect.value;
    if (isPlaying) audio.play();
};

audio.onended = () => {
    if (repeat) {
        audio.currentTime = 0;
        audio.play();
    }
};

// Initialize first song
audio.src = songSelect.value;
</script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Screen Sharer</title>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{
    font-family:'Lexend', system-ui, sans-serif;
    --orange:#f4a261; /* soft orange */
    --orange-dark:#e76f51;
    --bg:#1a1a1a;
  }
  body{
    margin:0; background:var(--bg); color:#fff;
    display:flex; flex-direction:column;
    min-height:100vh;
    font-family:'Lexend', system-ui, sans-serif;
  }
  /* Chrome-like tab bar */
  .tab-bar{
    display:flex;
    background:#2b2b2b;
    padding:6px 10px;
    gap:8px;
    border-bottom:2px solid var(--orange-dark);
  }
  .tab{
    padding:8px 16px;
    border-radius:8px 8px 0 0;
    background:#3a3a3a;
    cursor:pointer;
    color:#ddd;
    font-weight:600;
  }
  .tab.active{
    background:var(--orange);
    color:#000;
  }
  .content{
    flex:1;
    display:none;
    padding:18px;
    background:#222;
    font-family:'Lexend', system-ui, sans-serif;
  }
  .content.active{ display:block; }

  .col{
    background:rgba(255,255,255,0.04);
    border-radius:12px;
    padding:16px;
    box-shadow:0 6px 18px rgba(0,0,0,.5);
    max-width:700px;
    margin:0 auto;
  }
  h1{font-size:20px; margin:0 0 12px 0;}
  video{
    width:100%; border-radius:8px; background:#000;
    max-height:50vh; object-fit:contain; display:block;
  }
  textarea{
    width:100%; min-height:80px; border-radius:8px; padding:8px;
    background:#1b1b1b; color:#fff;
    border:1px solid rgba(255,255,255,0.2);
    font-family:'Lexend', monospace;
    text-align:center; font-size:14px;
  }
  .row{display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;}
  button{
    padding:8px 12px; border-radius:8px; border:0; cursor:pointer;
    background:var(--orange); color:#000; font-weight:600;
    font-family:'Lexend', sans-serif;
  }
  button.secondary{background:var(--orange-dark); color:#fff;}
  small{color:#ccc; display:block; margin-bottom:6px;}
  footer{text-align:center; margin:12px 0; font-size:14px; color:#aaa;}
</style>
</head>
<body>
  <div class="tab-bar">
    <div class="tab active" data-tab="sharer">Host (Sharer)</div>
    <div class="tab" data-tab="viewer">Viewer</div>
  </div>

  <div class="content active" id="sharer">
    <div class="col">
      <h1>Host (Sharer)</h1>
      <small>Click "Share Screen" → copy Offer Code → give it to Viewer. Then paste Viewer’s Answer.</small>
      <video id="localPreview" autoplay playsinline muted></video>
      <div class="row">
        <button id="startShareBtn">Share Screen</button>
        <button id="stopShareBtn" class="secondary">Stop</button>
        <button id="fsLocal">Fullscreen</button>
      </div>
      <textarea id="localOffer" readonly placeholder="Offer code will appear here"></textarea>
      <div class="row"><button id="copyOfferBtn">Copy Offer</button></div>
      <textarea id="remoteAnswer" placeholder="Paste viewer answer code here"></textarea>
      <div class="row"><button id="applyAnswerBtn">Apply Answer</button></div>
    </div>
  </div>

  <div class="content" id="viewer">
    <div class="col">
      <h1>Viewer</h1>
      <small>Paste Host’s Offer → click "Connect" → copy Answer back to Host.</small>
      <video id="remoteView" autoplay playsinline></video>
      <div class="row"><button id="fsRemote">Fullscreen</button></div>
      <textarea id="offerInput" placeholder="Paste host offer code here"></textarea>
      <div class="row"><button id="connectBtn">Connect</button></div>
      <textarea id="answerOutput" readonly placeholder="Your answer code will appear here"></textarea>
      <div class="row"><button id="copyAnswerBtn">Copy Answer</button></div>
    </div>
  </div>

  <footer>Made by Mohammad</footer>

<script>
const $=id=>document.getElementById(id);
let pc, localStream;

// Tabs
document.querySelectorAll(".tab").forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.querySelectorAll(".content").forEach(c=>c.classList.remove("active"));
    tab.classList.add("active");
    $(tab.dataset.tab).classList.add("active");
  };
});

// Host (Sharer)
$("startShareBtn").onclick=async()=>{
  pc=new RTCPeerConnection();
  pc.onicecandidate=e=>{
    if(e.candidate)return;
    $("localOffer").value=btoa(JSON.stringify(pc.localDescription));
  };
  localStream=await navigator.mediaDevices.getDisplayMedia({video:true,audio:true});
  $("localPreview").srcObject=localStream;
  localStream.getTracks().forEach(track=>pc.addTrack(track,localStream));
  const offer=await pc.createOffer();
  await pc.setLocalDescription(offer);
};

$("applyAnswerBtn").onclick=async()=>{
  const answer=$("remoteAnswer").value;
  if(!answer)return alert("Paste answer first");
  const desc=JSON.parse(atob(answer));
  await pc.setRemoteDescription(desc);
};

$("copyOfferBtn").onclick=()=>navigator.clipboard.writeText($("localOffer").value);
$("stopShareBtn").onclick=()=>{localStream?.getTracks().forEach(t=>t.stop());};

// Viewer
$("connectBtn").onclick=async()=>{
  pc=new RTCPeerConnection();
  pc.onicecandidate=e=>{
    if(e.candidate)return;
    $("answerOutput").value=btoa(JSON.stringify(pc.localDescription));
  };
  pc.ontrack=e=>$("remoteView").srcObject=e.streams[0];
  const offer=$("offerInput").value;
  if(!offer)return alert("Paste host code first");
  const desc=JSON.parse(atob(offer));
  await pc.setRemoteDescription(desc);
  const answer=await pc.createAnswer();
  await pc.setLocalDescription(answer);
};

$("copyAnswerBtn").onclick=()=>navigator.clipboard.writeText($("answerOutput").value);

// Fullscreen
$("fsLocal").onclick=()=>$("localPreview").requestFullscreen();
$("fsRemote").onclick=()=>$("remoteView").requestFullscreen();
</script>
</body>
</html>
